<!DOCTYPE html>
<html>
<head>
  <title>Truy cập Google Sheet</title>
  <script src="https://apis.google.com/js/api.js"></script>
</head>
<body>
  <script>
    // Thông tin xác thực
    const credentials = {
      "type": "service_account",
  "project_id": "tracuudulieu",
  "private_key_id": "e53c452ded992dc40b5dc9b9516549c25a52166c",
  "private_key": "-----BEGIN PRIVATE KEY-----\nMIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQDUxDmiqyZmZhkE\nyGYxAslpn4Q3oxQ/OPHTn2g40rOV58wW4rRda+TVzhZUYSG+xjvDRZiFXPNHYJ78\nJPUTVYIKAf6uQtOvrEKkZtN6ZdOL8w7S4MjHD0C2pYffrrXqGndFXkwroLF4X1YU\njRLnmlay4I0A3/i9pEosWlbye4yWvHn4TqXq4fPk9EyrprBZGRu8/JUBpYS0GQ2j\nsd5bmx4mzL/vGrhettjwfRILHHikzj6WBlqwKC/7O7atRy+40Pfk2J3LVCk5Q3P+\nIELGPDcTTlXDyoj++B0DitYVB7VXW7gAteSGyWgO8Gfo2xD0kUF3zGf7AxLCcGnq\njvzDjLsPAgMBAAECggEAD7fNUDSXmiH5wC4zynQbwAdOQ7Py93az+r/Aec4rASyG\nGby2uV4Soi7e3G3uicLoQFVAXr3OpRvAsvzh9AMxn56lG2eJbuVpaO7FubmTBrg2\nhKKhgn8gdz3ES2SDQN+ipwe/1ctBwRQ97je7yUtQE1feYs2o+Q2NgzhLSw+Qg8QX\nLuERQxYQQ7oNCsjYn3d63QEhwWcqv+RlvreW5l+Tw0aLzBSx9LV1tG9q5W8Dt1Ct\n9Vg3smUolyjyN6fKuU/Yh2EZmBeP9V5Mxf8B9Qy0mpqfiDflWqXuB3ZQuOJF9qsQ\nfLAGp90AncAIGJgxEGXeaJUSCAToKzVWwa5ovrItYQKBgQD2+8DWTCGqPHlPtAhO\nbnwSllqqARl57lonpqXjcPBrzQErMjg2t2DJ85sIlTBbZbCi06L6Q7vVqpxa/w0r\nKqOEv6+F6kO+IB0YuT/SgFpFHbb8NHJ5qB1iFLBm1s6QKJfZsgWOlz3YDTVTFlDy\nmOqLC+oJx5BgeFXd/24Z28Lo7wKBgQDciLBicvqXczepnd4GG1wc3+JpxVsz7vR0\nZ4WQDk55MwwPRYst9KwKLoAy0VLRe+b/04LBqCePyEeCxvIc0e9GnIxRG4KuXEMx\nZuM+VBI9SqFqYghssJjB/2lm5481k89cWdGM2n35dHbaTupfDBpB28V3ExCMXwQM\nsoQId+gP4QKBgDQ4vOhSxpd5G+lXVp5GzCMd+WOSwfE/DX7uxIqXma4hdYrNnocr\nNOLeiDxDVyssEDINb5tc8P1XiqHO5djnthVedl1pUBOGNMDCgpUeoHeWtdcTu9Sv\nUC8p0rab2qcufhUAiB5DKkdhW5IK2OjCnmzyAvU4ZfWP3BAJbx02kzqvAoGBALpa\n91H5/zADuMGoGXnnnMr5lYXzs8IK5p+G6yJ0NHPOYx50kcvfuZFRAhvvLqC+ptD/\nlrq2sdeaUnN8UhNwg1WT7C6NpLxaUp1oaBa/TDpm2kffV2chQ7SLdDH08ts/cDaF\n38G60ED/3X9UuFBhFb8ZS5/3iEBV+kIQh+nwCTWBAoGABLpMbTlyu2zFpsrLiA34\nOqBwcGWwDXCDRzodd9ESZSz6GYu3UHlqeFWyFfFiWBrMfIk1uy2x+Z9iddB0VjZP\nZrWTilR6Lfq7LzoJSnYaEN0FE4yzzVQgRIFQS5QQPY9xIDYsbjZnLZpb0v4136Ul\nDOmggpwOpsnCWBghTNezqiQ=\n-----END PRIVATE KEY-----\n",
  "client_email": "tracuu@tracuudulieu.iam.gserviceaccount.com",
  "client_id": "116862381530988950616",
  "auth_uri": "https://accounts.google.com/o/oauth2/auth",
  "token_uri": "https://oauth2.googleapis.com/token",
  "auth_provider_x509_cert_url": "https://www.googleapis.com/oauth2/v1/certs",
  "client_x509_cert_url": "https://www.googleapis.com/robot/v1/metadata/x509/tracuu%40tracuudulieu.iam.gserviceaccount.com",
  "universe_domain": "googleapis.co
    };

    const apiKey = 'AIzaSyCMH8cnICLHpQQXjDcwccK19RDzqeixBeM'; // Thay thế bằng khóa API của bạn
    const spreadsheetId = '190EYC31e6-IBXC_iemm8lWhkLLHS_5cso-FlNdoYdb0'; // Thay thế bằng ID của Google Sheet
    const range = 'Data!A:F'; // Thay thế bằng phạm vi dữ liệu

    // Xác thực và truy cập dữ liệu Google Sheet
    async function accessGoogleSheet() {
      try {
        await gapi.client.init({
          apiKey,
          discoveryDocs: ["https://sheets.googleapis.com/$discovery/rest?version=v4"],
          clientId: credentials.client_id,
          scope: "https://www.googleapis.com/auth/spreadsheets.readonly",
        });

        await gapi.client.load("sheets", "v4");
        await gapi.auth2.getAuthInstance().signIn();

        const response = await gapi.client.sheets.spreadsheets.values.get({
          spreadsheetId,
          range,
        });

        const data = response.result.values;
        console.log(data);
      } catch (error) {
        console.error("Đã xảy ra lỗi:", error);
      }
    }

    // Khi tài liệu HTML được tải, gọi hàm accessGoogleSheet để truy cập Google Sheet
    document.addEventListener('DOMContentLoaded', accessGoogleSheet);
  </script>
</body>
</html>
