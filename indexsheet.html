<!DOCTYPE html>
<html>
<head>
  <title>Truy cập Google Sheet</title>
  <script src="https://apis.google.com/js/api.js"></script>
</head>
<body>
  <script>
    // Thông tin xác thực
    const credentials = {
      web: {
    client_id: '1055501954789-rv6o5p13l873gjtgnse01r1s3qqotg8l.apps.googleusercontent.com',
    project_id: 'tracuudulieu',
    auth_uri: 'https://accounts.google.com/o/oauth2/auth',
    token_uri: 'https://oauth2.googleapis.com/token',
    auth_provider_x509_cert_url: 'https://www.googleapis.com/oauth2/v1/certs',
    client_secret: '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',
    redirect_uris: ['https://tuanviet-phuyen.github.io/mcp/indexsheet.html'],
    javascript_origins: ['https://tuanviet-phuyen.github.io']
  }
    };

    const apiKey = 'AIzaSyCMH8cnICLHpQQXjDcwccK19RDzqeixBeM'; // Thay thế bằng khóa API của bạn
    const spreadsheetId = '190EYC31e6-IBXC_iemm8lWhkLLHS_5cso-FlNdoYdb0'; // Thay thế bằng ID của Google Sheet
    const range = 'Data!A:F'; // Thay thế bằng phạm vi dữ liệu

    // Xác thực và truy cập dữ liệu Google Sheet
    async function accessGoogleSheet() {
      try {
        await gapi.client.init({
          apiKey,
          discoveryDocs: ["https://sheets.googleapis.com/$discovery/rest?version=v4"],
          clientId: credentials.client_id,
          scope: "https://www.googleapis.com/auth/spreadsheets.readonly",
        });

        await gapi.client.load("sheets", "v4");
        await gapi.auth2.getAuthInstance().signIn();

        const response = await gapi.client.sheets.spreadsheets.values.get({
          spreadsheetId,
          range,
        });

        const data = response.result.values;
        console.log(data);
      } catch (error) {
        console.error("Đã xảy ra lỗi:", error);
      }
    }

    // Khi tài liệu HTML được tải, gọi hàm accessGoogleSheet để truy cập Google Sheet
    document.addEventListener('DOMContentLoaded', accessGoogleSheet);
  </script>
</body>
</html>
